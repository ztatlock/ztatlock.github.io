# ztatlock.net

Repo for [Zachary Tatlock's website](https://ztatlock.net), built as a static site with [djot](https://djot.net/) and [make](https://www.gnu.org/software/make/).

## Repo Layout

- Top-level `*.dj`: source pages.
- Top-level `*.html`: generated pages committed for hosting.
- Top-level `*.meta`: optional page-specific metadata inserted into `<head>`.
- `templates/`: shared page wrappers, global references, and helper scripts.
- `templates/REFS`: global link references appended to every generated page.
- `pubs/<year-conf-sys>/`: publication assets (PDF, bib, images, slides, posters, etc.).
- `img/`: shared site images/icons.
- `sitemap.txt` and `sitemap.xml`: generated by `make`.

Standalone top-level pages without `.dj` sources:
- `anagram.html`
- `demo-naive-union-find.html`
- `sundial.html`

## Build And Validation

Prerequisites:
- `make`
- `djot` CLI
- `bash`
- `wget` (only needed for `templates/index-now.sh`)

Commands:
- `make all` builds all `*.dj -> *.html` pages plus `sitemap.txt` and `sitemap.xml`.
- `make <page>.html` rebuilds one page.
- `make clean` removes generated pages that come from `.dj` sources plus sitemap files.
- `bash templates/check.sh` checks for unresolved placeholders in publication/meta files.

## Editing Workflow

1. Edit `<page>.dj`.
2. Update/add `<page>.meta` if metadata should change.
3. Rebuild with `make <page>.html` or `make all`.
4. Commit both source and regenerated outputs.

Notes:
- If a page has both `<page>.dj` and `<page>.html`, treat `.dj` as source of truth.
- `templates/HEAD.1`, `templates/HEAD.2`, and `templates/FOOT` wrap all generated pages.
- The first line of each `.dj` file provides the page title in the generated HTML.
- Add or update named references in `templates/REFS` when using `[Name][]` links.

## Publication Bootstrap

Use `templates/mkpub.sh` to create a new publication scaffold:

```bash
bash templates/mkpub.sh YEAR-CONF-SYS
```

This creates:
- `pub-YEAR-CONF-SYS.dj`
- `pub-YEAR-CONF-SYS.meta`
- `pubs/YEAR-CONF-SYS/`

Then fill in placeholders, add assets, and rebuild with:

```bash
make pub-YEAR-CONF-SYS.html
```

## Publishing

This repo is served as a static site with a custom domain (`CNAME`), so generated HTML and sitemap files are committed.

## Roadmap

Outstanding TODOs and follow-up work are tracked in `ROADMAP.md`.
